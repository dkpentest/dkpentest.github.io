<!DOCTYPE html>
<html class="no-js" lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="theme-color" content="#1b1b1b">
	<title>Data_Security_Framework | drunk for pentest</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="stylesheet" href="/css/bundle.css">
	<link rel="icon" href="/icons/16.png" sizes="16x16" type="image/png">
	<link rel="icon" href="/icons/32.png" sizes="32x32" type="image/png">
		
</head>
<body class="body kind-page">
	<header class="header">
	<a class="logo" href="/">drunk for pentest</a>
	
</header>
	<div class="primary">
	
	<main class="main">
		
		<div class="single block">
			<article class="entry">
				<h1 class="entry__title">Data_Security_Framework</h1>
				<div class="entry__content"><h3 id="数据安全框架">数据安全框架</h3>
<p>企业安全服务于企业业务（除非安全本身就是企业业务），企业业务因安全而得以存续。其中，符合业务功能设计预期的利用，笔者认为统称“业务安全”，主要在合规语境下讨论（如隐私合规、反黑产等）。而不符合业务功能设计预期的利用，属于“网络安全”的范畴，主要在技术语境下讨论（如终端安全、服务端安全等）。数据安全，是介于业务安全合规、和网络安全技术中间的部分，即受地缘合规要求所驱动，也同网络安全技术措施强关联。</p>
<hr>
<h5 id="数据安全与隐私保护在安全合规全局中的定位">数据安全与隐私保护在安全合规全局中的定位</h5>
<pre tabindex="0"><code>
                                ┌―内容安全
                       ┌―反黑产――│ 反诈
                       │        │ 账号流量
                       │        └―设备
            ┌―业务安全――│
            │          │      ┌― ...
            │          └―合规――│
            │                 └―隐私保护         
企业安全框架――│
            │                      ┌―数据安全
            │          ┌―服务端安全――│ 云原生安全
            └―网络安全――│            └―主机系统安全
                       │ 
                       └―终端安全――应用安全
</code></pre><p>（画的挫，是那么个意思，凑合看）</p>
<hr>
<h5 id="量化评价数据安全体系">量化评价数据安全体系</h5>
<p>解决一个企业的数据安全体系建设，首先要全面的评估该企业目前的现状。可以通过数据安全风险评估方法（国内外都有标准）进行全面评估，按照评估结论进行综合打分。评估范围主要包括：</p>
<pre tabindex="0"><code>管理规范类：
    - 数据资产管理
    - 数据分类分级
    - 权限管理
    - 日志管理
    - 安全审计
    - 应急响应
    - 举报投诉处理
    - 教育培训
    - 合作方管理
    - 平台系统安全管理
    - 机构岗位人员管理

技术措施类评估：
    - 数据采集
    - 数据传输
    - 数据存储
    - 数据使用
    - 数据开放共享
    - 数据出境
    - 数据销毁
</code></pre><p>值得注意的是，以上18大类136子类的评估，通常很难在千人规模以下的公司迅速开展。原因是每个人都只见树木不见森林，很难段时间内了解有效信息，因此按照笔者的经验，可以一边开展重点领域建设工作，一边同步进行评估。</p>
<hr>
<h5 id="数据安全体系建设">数据安全体系建设</h5>
<p>正向的体系建设和治理，要从以下三个方面入手：</p>
<ul>
<li>制定标准规范、制度流程</li>
<li>构建技术工具卡点</li>
<li>赋能人员能力、深度介入方案</li>
</ul>
<p>以下就前两者展开描述</p>
<hr>
<h6 id="制定标准规范制度流程">制定标准规范、制度流程</h6>
<p>制定标准规范，是为了确定什么是问题的标准，在符合一国一策的大背景下，需要基于以下 4+1 原则制定：</p>
<ul>
<li>上位法</li>
<li>行政法规</li>
<li>国家/行业标准</li>
<li>公司内规</li>
<li>参考行业优秀实践</li>
</ul>
<p>作为基础标准，至少需要具备：</p>
<ul>
<li>数据分级分类保护安全规范
需要将数据资产按照数据的类型（200+）、数据的级别（5）、数据的技术载体（mysql、mariadb、redis、cos、kafka、hive、es等）进行对号入座，并对不同级别的数据提出对应的安全措施要求</li>
<li>权限管理规范
需要制定功能/权限风险等级量化评估的标准，不同风险权限对应的审批流程标准</li>
<li>资源/安全审计规范
需要制定业务有价虚拟资源清单以及SOD（separation of duty）指责分离矩阵</li>
</ul>
<hr>
<h6 id="构建技术工具卡点">构建技术工具卡点</h6>
<p>技术工具层面，至少要具备：</p>
<ul>
<li>动态感知数据地图的分级分类工具，以掌握数据资产的风险分布情况</li>
<li>云组件的资产标签管理工具</li>
<li>统一鉴权管理工具</li>
<li>安全审计工具</li>
</ul>
<hr>
<h6 id="分级分类词典">分级分类词典</h6>
<blockquote>
<p>用户数据</p>
<blockquote>
<p>个人用户数据</p>
<blockquote>
<p>身份鉴权信息</p>
<blockquote>
<p>【三级】用户基本资料：年龄、性别、生日、职业类型、国籍、工作单位、职业、办公地址<br>
【四级】用户基本资料：家庭住址、办公电话、宗教信仰、种族等特殊身份<br>
【三级】身份证明：姓名\昵称<br>
【四级】身份证明：身份证、社保卡、驾照、护照、军官证<br>
【四级】生物特征：面部识别特征、指纹、声纹、掌纹、耳廓、基因信息、虹膜<br>
【三级】普通服务身份标识和鉴权信息：微信号、QQ号、微博、openudid、UUID<br>
【四级】普通服务身份标识和鉴权信息：手机号、邮箱<br>
【四级】交易类服务身份标识和鉴权信息：支付宝等交易账号、交易密码、密码保护答案</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>用户数据和服务内容</p>
<blockquote>
<p>【四级】服务内容信息：通话内容、短信、彩信、即时通信内容、网络数据文件、邮件内容、会议主题、会议内容、关键词<br>
【四级】联系人信息：通讯录、好友列表、群组列表<br>
【三级】用户似有资料数据：文字信息、多媒体信息、剪贴板内容<br>
【三级】私密社交内容：特定群体社交信息、群组发布内容、设置权限社交平台内容</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>用户服务相关信息</p>
<blockquote>
<p>【三级】业务订购、订阅关系：业务订购信息、业务注册时间、修改注销状况信息<br>
【三级】服务记录和日志：停留时间、应用使用频次、使用时间、访问日期和时间<br>
【四级】服务记录和日志：网页浏览记录（访问网址、缓存文件）、应用适用记录（广告点击记录、感兴趣的内容识别）、点击操作记录（收藏、关注、点赞、转发、分享、互动、添加购物车、下载记录）、帐户配置（页面浏览偏好设置、存储的账号密码）<br>
【三级】消费信息和账单：停开机、入网时间、在网时间、付费方式<br>
【四级】消费信息和账单：积分、预存款、信用等级、信用额度、缴费情况、账单（固定费用、通信费用、数据费用、代收费用、余额等）<br>
【二级】位置数据：仅能定位到行政区、县级的位置数据<br>
【三级】位置数据：附近的WiFi、街道小区等地标<br>
【四级】位置数据：经纬度数据、持续定位产生的轨迹信息<br>
【二级】用户设备信息：ODID、CAID、IDFA、CPU、内存、操作系统名称、版本、应用软件列表、每款应用软件名称、应用软件版本、应用市场、操作时间、异常信息、应用崩溃事件<br>
【三级】用户设备信息：IMEI、IMSI、设备SN、MAC地址、EMMCID、CPUID、android_id、用户终端ID地址</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>健康医疗类</p>
<blockquote>
<p>【四级】一般健康数据：体温数据、心率数据、血压数据、BMI、体重、步数、运动类型、运动时常、运动距离、睡眠信息<br>
【四级】个人医疗数据：病症、住院志、医嘱单、体检报告、手术及麻醉记录、护理记录、用药记录、药物食物过敏信息、生育信息、以往病史、诊治情况、家族病史、现病史、传染病史<br>
【四级】性相关数据：性取向数据、性生活数据</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>个人财务信息类</p>
<blockquote>
<p>【二级】在线交易数据：购买记录、订单信息、订单号、交易双方名称、交易金额、交易时间、交易状态、商品名称、付款方式、交易配送信息、充值记录、行程预定信息<br>
【三级】支付凭证数据：卡片有效期<br>
【四级】支付凭证数据：网络账户信息、银行卡主账号、卡片验证码<br>
【四级】存款信息：银行存款<br>
【三级】保险信息：保险期限<br>
【四级】保险信息：保险金额<br>
【四级】信贷信息：授信额度、担保人、抵押财产、还款方式、还款金额<br>
【二级】退休金计划：生效日期<br>
【二级】退休金计划：受益人<br>
【四级】征信信息：个人信用报告<br>
【四级】虚拟财产信息：虚拟货币、游戏兑换码<br>
【三级】房产信息：自有/租赁、居住期限、房租、估价、房屋产权<br>
【四级】房产信息：居住地址<br>
【二级】车辆信息：车辆型号、车辆识别代码、发动机号码<br>
【三级】车辆信息：车牌号<br>
【四级】车辆信息：行车记录</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>行为和社会活动信息</p>
<blockquote>
<p>【三级】行为数据：性格、抽烟喝酒情况、生活方式、使用的社交媒体、业余爱好<br>
【三级】社会活动数据：移民情形、担任的公共职能、意外、事故、投诉信息、荣誉信息、服役信息、会员资格</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>教育和工作信息</p>
<blockquote>
<p>【二级】教育数据：教育的经费投入、专业资质、专业经历、专业机构成员资格、出版物<br>
【三级】教育数据：教育经历、学历、学位、成绩单<br>
【二级】工作数据：职位及描述、工作类型、岗位培训信息<br>
【三级】工作数据：工作单位、工作经历、工作表现<br>
【四级】工作数据：工资、公司分配的资产</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>公共利益类</p>
<blockquote>
<p>【四级】宗教信仰：用户宗教信仰<br>
【二级】违法犯罪信息：职位及描述、工作类型、岗位培训信息已公开的用户涉嫌犯罪信息、定罪和判决信息、行政处罚信息<br>
【四级】违法犯罪信息：未公开的违法犯罪记录<br>
【三级】民族/种族信息：民族、语言、肤色<br>
【四级】民族/种族信息：种族</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>儿童个人信息类</p>
<blockquote>
<p>【四级】儿童个人信息（未满14岁）：所有儿童个人信息</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>用户画像类</p>
<blockquote>
<p>【三级】信用标签：欺诈数据、套现数据、刷单数据、羊毛党数据<br>
【三级】消费行为：消费金额、充值次数、购买转化行为<br>
【三级】社交行为：加群行为、互动行为、评论内容、收藏<br>
【三级】行为习惯：旅行习惯、运动习惯、消费习惯<br>
【三级】营销偏好：营销渠道偏好、营销活动类型偏好、营销触达时间偏好、营销渠道变更、渠道id</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>网络运营商信息</p>
<blockquote>
<p>【二级】WiFi信息：基站信息/小区、联网类型、接入网络方式、接入网络类型、接入网络状态、附近的WiFi、连接的WiFi、无线网SSID、WLAN接入点<br>
【三级】WiFi信息：IP地址<br>
【二级】运营商信息：MCC、MNC、运营商国家码</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>企业用户数据</p>
<blockquote>
<p>单位基本信息</p>
<blockquote>
<p>【一级】单位基本概况：单位股东名称、企业名称、统一社会信用代码、经营范围、行业分类、人员规模、注册资本、企业地址<br>
【二级】单位基本概况：法人姓名、高管姓名、自然人股东姓名<br>
【二级】单位联系信息：通信地址、企业办公电话<br>
【三级】单位联系信息：联系人姓名<br>
【三级】单位财务信息：营业收入、利润来源</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>单位资讯信息</p>
<blockquote>
<p>【二级】传统鉴别信息：公钥<br>
【四级】传统鉴别信息：私钥<br>
【三级】企业信贷信息：信贷纪录<br>
【三级】企业税务信息：税务号、税务登记证影印件、税务登记有效期等</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>单位标签信息</p>
<blockquote>
<p>【三级】基础标签信息：金融客户标签<br>
【三级】关系标签信息：供应链和新客户标签<br>
【三级】签约标签信息：网银签约标签<br>
【三级】交易类标签信息：结算客户标签<br>
【三级】行为标签信息：偏好使用网银客户标签<br>
【三级】营销服务标签信息：战略客户标签<br>
【三级】风险标签信息：高风险客户标签<br>
【三级】价值标签信息：贡献度、客户评级、合同名称、合同状态、签订日期、合同金额、付款方式、付款币种<br>
【三级】履约记录：履约记录<br>
【三级】资金往来情况：银行转帐纪录<br>
【三级】业务流水数据：内容曝光、点击播放、转点评、商业化广告曝光点击</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<p>业务数据</p>
<blockquote>
<p>【三级】业务流水数据：内容曝光、点击播放、转点评、商业化广告曝光点击<br>
业务运营指标</p>
<blockquote>
<p>【二级】内容类：内容时长、停留市场、播放率、点击次数、好友数、互动率、内容分享、DAU<br>
【二级】社交类：粉丝数、兴趣点、忠诚度、留存率、回流率、流失率<br>
【二级】电商类：GMV、复购率、均购物车大小、转化率、ARPU、交易次数、交易金额、付费信息<br>
【二级】内容特征：图文内容、内容画像、帐号等级、品牌、类别名称、运营规则、完播率、广告类型、广告消费、敏感词、爆款标记、推荐等级、公募金衍生指标、债权数据、指数数据、金融市场机构主体数据、理财数据、国内宏观数据、国际宏观数据</p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<p>经营管理数据</p>
<blockquote>
<p>企业管理类</p>
<blockquote>
<p>【四级】发展战略与重大决策：涉及公司发展方向、发展战略及其他重大决策的数据，如战略规划、战略风险评估、相关会议纪要等<br>
【三级】财务类：财务数据<br>
【四级】财务类：核心财务数据（公司年度投资计划数据、公司年度预算数据、财务审计信息、会计凭证和账簿数据，纳税相关数据等）<br>
【三级】人力资源类：员工一般个人信息（出生年月、绩效等级、姓名、民族、性别、国籍、员工任职级别、员工所属部门）<br>
【四级】人力资源类：员工敏感个人信息（如身份证号、婚姻状况、政治面貌、护照号、照片、手机号、紧急联系人电话、借记卡账号、信用卡账号、薪酬、股权、常用经纬度、精确地址信息(精确到街道)、邮寄详细地址、身份证地址等）<br>
【三级】供应商类：供应商管理流程、供应商评价信息、供应商名册、供应商档案<br>
【二级】章程制度类：为维护正常工作经营秩序，保证工作合法合规进行所制定的具有指导性和约束力的章程制度，如公司章程以及公司各类管理制度等<br>
【二级】办公类：一般指办公过程中产生的各类信息，如文档管理、审批管理、邮件管理、党务纪检管理等数据</p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>业务经营类</p>
<blockquote>
<p>【四级】商业秘密类：核心产品代码、设计文档及算法、未公开的技术专利、系统账号、产品IP、原型图、素材、密码、密钥<br>
【一级】知识产权类：专利、商标、享有著作权的作品等</p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>监管类</p>
<blockquote>
<p>【一级】信息披露数据：公司为履行信息披露义务所需要披露的各类数据，如定期报告、临时报告等<br>
【四级】监管数据：向监管机构报送的各项信息（监管机构发送的评价、处罚、违规、统计、预警及安全审计等信息）</p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<p>系统运行与安全数据</p>
<blockquote>
<p>系统运行数据</p>
<blockquote>
<p>【三级】建设类：网络建设、网络拓扑结构、新增设备信息、设备采购、位置、性能等基础建设数据<br>
【三级】网络与系统资源类：公共资源、传输资源、承载网资源、核心网、接入网、IT系统、云资源等数据<br>
【三级】网络与系统运维类：设备检测、告警、流量检测、运维日志、系统运行状况等数据<br>
【四级】网络与系统运维类：运维系统账号密码</p>
</blockquote>
</blockquote>
</blockquote>
<blockquote>
<blockquote>
<p>网络安全数据</p>
<blockquote>
<p>【三级】网络安全管理类：安全审计记录、网络安全应急预案、违法有害信息监测、核心区域监控、网络威胁等数据</p>
</blockquote>
</blockquote>
</blockquote>
<hr>
<h6 id="分级安全保护措施">分级安全保护措施</h6>
<p>收集要求</p>
<pre tabindex="0"><code>a）在不影响系统流程的前提下，具有数据敏感度的界定标准，能够根据数据的敏感度进行分类【二级以上】
b）对收集的数据进行分级【二级以上】
c）事先得到对待收集的数据的授权【二级以上】
d）记录异常收集行为并告警【三级以上】
e）对收集系统进行接入鉴权，限制其IP地址，端口号等，同时进行基于帐号密码的认证鉴权，防止恶意工具非法收集数据【四级以上】
f）禁止通过设备拓展接口进行数据访问【五级以上】
g）对五级数据收集设备进行物理隔离，并采用多人分级分权形式进行设备的管理、维护【五级以上】
h）记录异常收集行为日志，包括记录出现异常的文件名、收集时间、收集序列号、收集异常信息描述等，以便为后续异常处理提供详细的参考信息【五级以上】
i）对重复收集量超过设定与之的情况给予警告【五级以上】
j）对数据员进行鉴别筛选，筛除能够识别的错误、问题数据【五级以上】
</code></pre><p>传输要求</p>
<pre tabindex="0"><code>a）采取加密等技术措施保证数据传输的机密性【二级以上】
b）对传输过程中传输中断的情况给予告警【三级以上】
c）传输过程中对目标文件库的存储量超过设定阈值的情况给予告警【三级以上】
d）确保数据在传输过程中的数据的机密性和完整性不收到破坏【四级以上】
e）对重复传输量超过设定与之的情况给予告警【五级以上】
f）能够检测到数据在传输过程中完整性受到破坏，并在检测到完整性错误是采取必要的恢复措施【五级以上】
</code></pre><p>存储要求</p>
<pre tabindex="0"><code>a）提供有效的访问控制机制，防止数据被非法授权访问【二级以上】
b）支持对密码算法、强度和方式等参数的可选配置【三级以上】
c）采用加密技术或其他保护措施，实现数据的存储机密性【三级以上】
d）对数据重大操作应纳入多人操作管理模式，确保单人无法拥有数据的完整操作权限【三级以上】
e）提供基于角色等的细粒度访问控制机制【四级以上】
f）能够检测到数据在存储过程中完整性受到破坏【四级以上】
g）能够检测到数据在存储过程中完整性受到破坏，并检测到完整性错误时采取必要的恢复措施【五级以上】
h）提供机遇数据库表列等级别的细粒度访问控制机制【五级以上】
</code></pre><p>处理要求</p>
<pre tabindex="0"><code>a）能发现数据处理得异常行为并告警【二级以上】
b）能够实现对数据的屏蔽、隐藏，能够灵活控制返回给用户的数据流中的敏感信息，从而达到敏感数据保护的目的【三级以上】
c）数据处理平台内所有组件之间应开启认证【四级以上】
d）数据处理过程中，能对异序执行行为发现并告警；【五级以上】
e）能发现接口调用、指令执行间隔异常并告警【五级以上】
f）对长时间执行某一项数据库操作或访问某块数据的英勇行为进行监测并告警【五级以上】
g）提供基于针对数据字段编码规则（如身份证号、IMEI等编码规则）的分析，进而发现数据字段中存在的潜在敏感信息（如IMEI中隐含的品牌信息等）【五级以上】
h）能够发现因数据二次关联产生的新敏感数据【五级以上】
</code></pre><p>使用要求</p>
<pre tabindex="0"><code>a）对请求使用数据的用户或应用程序进行认证及权限控制【二级以上】
b）若上层应用涉及到对敏感数据的访问时，提供数据脱敏功能【二级以上】
c）采用页面水印等方式，便于对数据使用的追踪【二级以上】
d）若需要到处部分数据用于测试，或是需要数据共享等场景，通过流程审批进行管控，并对导出数据进行脱敏【二级以上】
e）提供统一的数据使用访问接口【三级以上】
f）在数据导出场景下，支持数据的有限导出【三级以上】
g）提供上层应用得异常行为分析、发现及告警功能，能够及时发现数据使用中可能存在的风险点及攻击行为【三级以上】
h）对数据使用行为进行日志记录【三级以上】
i）对敏感数据的使用定期进行审计，并形成审计日志【三级以上】
j）提供基于用户名、IP地址等多种方式的认证及细粒度权限控制【四级以上】
k）提供多种数据脱敏算法、可配置【四级以上】
l）对展示和下载的数据进行脱敏【四级以上】
m）支持对数据的禁止导出功能；如果需要导出，应经过特殊的审批流程【四级以上】
n）对不具有敏感数据访问权限的应用请求访问敏感数据等非授权行为进行监测并告警【四级以上】
o）提供细粒度权限控制，能够对数据库表等多粒度进行授权【五级以上】
p）能支持对数据库不同操作（CRUD等）的独立授权【五级以上】
q）能支持对URI进行授权，已实现数据导入导出的权限控制【五级以上】
r）能针对不同用户和不同敏感数据动态配置不同的敏感数据脱敏算法【五级以上】
s）提供细粒度的敏感数据保护，配置用户查询特定数据库的特定表的特定列时的脱敏算法，在保证脱敏的同时不影响用户体验【五级以上】
t）能发现上层应用数据量异常访问行为进行并告警【五级以上】
</code></pre><p>销毁要求</p>
<pre tabindex="0"><code>a）支持删除、覆写数据并格式化【二级以上】
b）支持对数据存储介质的物理销毁【二级以上】
c）支持不可恢复性的数据销毁【三级以上】
</code></pre></div>
				
			</article>
		</div>
	</main>
	
	



	

	</div>
	<footer class="footer">
	<div class="footer__copyright">© 2024 drunk for pentest. <span class="footer__copyright-credits">Powered by <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/vimux/binario" rel="nofollow noopener" target="_blank">Binario</a> theme.</span></div>
</footer>
</body>
</html>