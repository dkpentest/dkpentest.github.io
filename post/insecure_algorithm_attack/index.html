<!DOCTYPE html>
<html class="no-js" lang="en-us">
<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="theme-color" content="#1b1b1b">
	<title>Insecure_Algorithm_Attack | drunk for pentest</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
	<link rel="stylesheet" href="/css/bundle.css">
	<link rel="icon" href="/icons/16.png" sizes="16x16" type="image/png">
	<link rel="icon" href="/icons/32.png" sizes="32x32" type="image/png">
		
</head>
<body class="body kind-page">
	<header class="header">
	<a class="logo" href="/">drunk for pentest</a>
	
</header>
	<div class="primary">
	
	<main class="main">
		
		<div class="single block">
			<article class="entry">
				<h1 class="entry__title">Insecure_Algorithm_Attack</h1>
				<div class="entry__content"><h3 id="算法攻击">算法攻击</h3>
<h5 id="0x0-概述">0x0 概述</h5>
<p>加密算法是整个 cyber security 的理论基石，其安全性主要取决于按照当前的工业算力是否能在合理的时间成本内解出算法难题（如RSA算法基于大数质因数分解问题，EC算法基于圆锥曲线问题）。</p>
<p>NIST（美国国家标准技术研究所 National Institute of Standards and Technology）每年都会针对安全加密算法进行公示，并提出安全算法和非安全算法建议。本文落点不在于推公式密码学意义上的算法安全性，而在于提出一些好用的词典和工具尝试破解非安全加密算法。</p>
<pre tabindex="0"><code>NIST网络安全标准：https://www.nist.gov/cybersecurity
SP 800-13A Rev.2：https://csrc.nist.gov/publications/detail/sp/800-131a/rev-2/final
</code></pre><p>除NIST外，还有许多密码学会、国家机构发布安全密码标准，不在此展开。NIST其实在历史上有过植入密码后门的黑历史。</p>
<hr>
<h3 id="0x1-安全算法和安全协议">0x1 安全算法和安全协议</h3>
<p>GCM模式：Galois Counter Mode 即counter模式，G代表GMAC，C代表CTR
MAC：消息验证码，一种带密钥的hash（跟CTR的区别在于可以在附加消息里添加ip等各种信息，作为消息验证码，保护完整性）
CTR模式：Counter模式，计数器模式，每次对逐次增加的计数器进行加密输出密钥流，然后把明文和密钥流进行异或
优点：单块缺失不影响整块解密
CBC模式：cipher-block chaining，密码分组链接模式
每一个密码块加密前都先和前面的密文块异或然后再加密（前面加密出来了后面才能解密）所以第一个明文需要一个初始向量
输出永远是16byte（128bit）整数倍
缺点：无法并行，不适合流数据加密
CFB模式：Cihper feedback，密文反馈模式
需要初始向量，前一段密文再加密后变成后一段向量，用于和明文异或
优点：block cipher 块密文，可转变为 stream cipher 流密文（需要前面的密文就能解密后面的密文，但是密文全知道）</p>
<p>常见填充算法</p>
<ul>
<li>NoPadding：需要明文本身必须是分组大小的整数倍（如128*）</li>
<li>PKCS5Padding</li>
<li>PKCS7Padding</li>
<li>ISO10126Padding</li>
<li>ISO7816-4Padding</li>
<li>ZeroBytePadding</li>
<li>X923Padding</li>
<li>TBCPadding（Trailing-Bit-Compliment）</li>
<li>PKCS1Padding</li>
</ul>
<hr>
<h3 id="0x2-非安全算法和非安全协议">0x2 非安全算法和非安全协议</h3>
<p>ECB模式：electronic codebook，电子密码本模式
优点：可以并行
缺点：1、安全性无法保证（如图加密）2、密文长度和明文相同 3、不适合加密大量数据
OFB模式：output feedback，输出反馈模式
先用初始向量和加密器生成密钥流，密钥流和明文异或出密文；反过来解密也是先生成密钥流，再和密文异或回明文
缺点：有已知安全漏洞</p>
<p>RSA keySize &lt; 2048<br>
DSA keySize &lt; 2048<br>
EC keySize &lt; 224<br>
SHA1<br>
SHA-1<br>
MD2<br>
MD4<br>
MD5<br>
RC2<br>
RC4<br>
DES</p>
<hr>
<h3 id="0x3-典型攻击方式">0x3 典型攻击方式</h3>
<p>字典攻击：区别于暴力破解尝试所有可能性，字典攻击按照用户词典里自定的几种密码可能性进行尝试
奥义：拥有一个好的词典</p>
<p>彩虹表攻击：单向哈希的逆运算，用于破解长度固定且字符范围固定的密码哈希（如信用卡、数字等），典型的空间换时间</p></div>
				
			</article>
		</div>
	</main>
	
	



	

	</div>
	<footer class="footer">
	<div class="footer__copyright">© 2024 drunk for pentest. <span class="footer__copyright-credits">Powered by <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/vimux/binario" rel="nofollow noopener" target="_blank">Binario</a> theme.</span></div>
</footer>
</body>
</html>